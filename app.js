var SendMail={};SendMail.http=require("http");SendMail.path=require("path");SendMail.fs=require("fs");SendMail.express=require("express");SendMail.bliss=require("bliss");SendMail._=require("underscore");SendMail.stylus=require("stylus");SendMail.nodemailer=require("nodemailer");SendMail.emailTemplates=require("email-templates-windows");SendMail.pjson=JSON.parse(SendMail.fs.readFileSync("package.json","utf8"));(function(b){var c=function(a,b,d,f,h){try{a.transport.sendMail({from:b,to:d,subject:f,html:h,generateTextFromHTML:!0},function(a,b){a?console.log(a):console.log(b.message)})}catch(c){console.log(c)}},e=function(a,i,d,f,h,e){b.emailTemplates(a.templatesDir,function(b,g){b?console.log(b):g(i,d,function(b,d){b?console.log(b):c(a,f,h,e,d)})})},g=function(){var a={transport:null,templatesDir:b.path.resolve(__dirname,".","templates")};a.transport=b.nodemailer.createTransport("SMTP",{service:"Gmail",auth:{user:b.pjson._user,
pass:b.pjson._psw}});return b._.extend(this,a)};g.prototype.sendWithTemplate=function(a,b,d,f,c){e(this,a,b,d,f,c)};g.prototype.send=function(a,b,d,f){c(this,a,b,d,f)};b.email=function(){var a={};return a=new g}})(SendMail);(function(b){b.routers={};b.routers.index=function(c,e){b.email.sendWithTemplate("newsletter",{},"no81no@gmail.com","no81no@gmail.com","Newsletter");e.render("index",{})}})(SendMail);(function(b){var c=function(a){a.app.get("/",b.routers.index);a.app.get("/index",b.routers.index)},e=function(a){var c=new b.bliss;a.app.engine(".html",function(a,b,e){e(null,c.render(a,b))})},g=function(a){a.app.configure(function(){a.app.set("port",process.env.PORT||8088);a.app.set("views",__dirname+"/content/views");a.app.set("view engine","html");a.app.use(require("stylus").middleware({src:__dirname+"/content",compress:!0}));a.app.use(b.express.favicon());a.app.use(b.express.logger("dev"));a.app.use(b.express.bodyParser());
a.app.use(b.express.methodOverride());a.app.use(a.app.router);a.app.use(b.express["static"](__dirname+"/content"))});e(a);a.app.configure("development",function(){a.app.use(b.express.errorHandler())})};(function(){var a={app:b.express()};b.email=new b.email;g(a);c(a);b.http.createServer(a.app).listen(a.app.get("port"),function(){console.log("Express server listening on port "+a.app.get("port"));b.email.sendWithTemplate("newsletter",{},b.pjson._to,b.pjson._to,"Newsletter")})})()})(SendMail);